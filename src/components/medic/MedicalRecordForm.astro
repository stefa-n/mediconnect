<!-- Medical Record Form Modal -->
<div id="medical-record-modal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-[95] p-4 overflow-y-auto">
  <div class="min-h-screen flex items-center justify-center py-8">
    <div id="medical-record-modal-content" class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full transform transition-all scale-95 opacity-0">
      <!-- Header -->
      <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-t-2xl">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 rounded-full bg-white/20 flex items-center justify-center backdrop-blur-sm">
              <i class="fas fa-file-medical text-2xl"></i>
            </div>
            <div>
              <h3 class="text-2xl font-bold">Add Medical Record</h3>
              <p id="medical-record-patient-name" class="text-blue-100 text-sm">Patient Name</p>
            </div>
          </div>
          <button id="close-medical-record-modal" class="text-white/80 hover:text-white transition-colors p-2">
            <i class="fas fa-times text-2xl"></i>
          </button>
        </div>
      </div>

      <!-- Form -->
      <form id="medical-record-form" class="p-6 space-y-4">
        <input type="hidden" id="mr-patient-id" />
        <input type="hidden" id="mr-appointment-id" />

        <!-- Diagnosis (Required) -->
        <div>
          <label class="block text-sm font-semibold text-gray-900 mb-2">
            Diagnosis <span class="text-red-500">*</span>
          </label>
          <input 
            type="text" 
            id="mr-diagnosis" 
            required
            placeholder="Primary diagnosis for this visit"
            class="w-full px-4 py-3 bg-white rounded-lg border-2 border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
          />
        </div>

        <!-- Symptoms -->
        <div>
          <label class="block text-sm font-semibold text-gray-900 mb-2">
            Symptoms
          </label>
          <textarea 
            id="mr-symptoms" 
            rows="3"
            placeholder="Patient reported symptoms..."
            class="w-full px-4 py-3 bg-white rounded-lg border-2 border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none"
          ></textarea>
        </div>

        <!-- Treatment -->
        <div class="relative">
          <label class="block text-sm font-semibold text-gray-900 mb-2">
            Treatment Plan
            <span class="text-xs text-gray-500 font-normal ml-2">
              Type <code class="bg-gray-100 px-1 rounded">#</code> to reference prescriptions or medical history
            </span>
          </label>
          <textarea 
            id="mr-treatment" 
            rows="3"
            placeholder="Treatment plan, procedures performed, recommendations..."
            class="w-full px-4 py-3 bg-white rounded-lg border-2 border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none"
          ></textarea>
          
          <!-- Autocomplete Dropdown -->
          <div id="mr-treatment-autocomplete" class="hidden absolute z-50 w-full mt-1 bg-white border-2 border-blue-500 rounded-lg shadow-xl max-h-64 overflow-y-auto">
            <!-- Autocomplete items will be inserted here -->
          </div>
        </div>

        <!-- Additional Notes -->
        <div class="relative">
          <label class="block text-sm font-semibold text-gray-900 mb-2">
            Additional Notes
            <span class="text-xs text-gray-500 font-normal ml-2">
              Type <code class="bg-gray-100 px-1 rounded">#</code> to reference prescriptions or medical history
            </span>
          </label>
          <textarea 
            id="mr-notes" 
            rows="3"
            placeholder="Any additional notes or observations..."
            class="w-full px-4 py-3 bg-white rounded-lg border-2 border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none"
          ></textarea>
          
          <!-- Autocomplete Dropdown -->
          <div id="mr-notes-autocomplete" class="hidden absolute z-50 w-full mt-1 bg-white border-2 border-blue-500 rounded-lg shadow-xl max-h-64 overflow-y-auto">
            <!-- Autocomplete items will be inserted here -->
          </div>
        </div>

        <!-- Visit Date -->
        <div>
          <label class="block text-sm font-semibold text-gray-900 mb-2">
            Visit Date <span class="text-red-500">*</span>
          </label>
          <input 
            type="datetime-local" 
            id="mr-visit-date" 
            required
            class="w-full px-4 py-3 bg-white rounded-lg border-2 border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
          />
        </div>

        <!-- Actions -->
        <div class="flex gap-3 pt-4">
          <button 
            type="button" 
            id="cancel-medical-record-btn"
            class="flex-1 px-6 py-3 rounded-lg border-2 border-gray-300 hover:bg-gray-50 font-semibold text-gray-700 transition-all"
          >
            Cancel
          </button>
          <button 
            type="submit"
            class="flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all shadow-lg hover:shadow-xl font-semibold"
          >
            <i class="fas fa-save mr-2"></i>
            Save Record
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<style>
  #medical-record-modal {
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }

  #medical-record-modal-content {
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), 
                opacity 0.3s ease-out;
  }
</style>
